<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Puffly | Sovereign Full Version</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff8fa3; --primary-grad: linear-gradient(135deg, #ffb3c1, #ff758f);
            --bg: #fff0f3; --card: #ffffff; --text: #4a2c32; --muted: #a38a8e;
            --accent: #ff4d6d; --bubble-me: #ffb3c1; --bubble-you: #ffe5ec;
            --nav-bg: rgba(255, 255, 255, 0.95);
            --puffly-blue: #87ceeb;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* Splash Screen */
        #splash { position: fixed; inset: 0; background: var(--primary-grad); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; transition: 0.8s; }
        .splash-logo { font-size: 60px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

        /* Layout */
        .view-section { flex: 1; display: none; overflow-y: auto; padding-bottom: 80px; }
        .active-view { display: block; }
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; height: 75px; background: var(--nav-bg); backdrop-filter: blur(15px); display: flex; justify-content: space-around; align-items: center; border-top: 1px solid rgba(0,0,0,0.05); z-index: 4000; }
        .nav-item { display: flex; flex-direction: column; align-items: center; gap: 5px; color: var(--muted); cursor: pointer; font-size: 11px; }
        .nav-item.active { color: var(--primary); }
        .nav-item i { font-size: 24px; }

        /* Reels & Follow */
        #homeView { background: #000; overflow: hidden; }
        .reel-video { position: relative; width: 100%; height: 100vh; display: flex; align-items: center; justify-content: center; color: white; }
        .reel-actions { position: absolute; bottom: 120px; right: 15px; display: flex; flex-direction: column; gap: 18px; align-items: center; }
        .action-btn { cursor: pointer; text-align: center; }
        .action-btn i { font-size: 32px; transition: 0.3s; }
        .action-btn.liked i { color: var(--puffly-blue); filter: drop-shadow(0 0 8px var(--puffly-blue)); }
        
        /* ‡∏ñ‡∏≤‡∏î‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÉ‡∏ï‡πâ‡∏Ñ‡∏•‡∏¥‡∏õ */
        #commentSheet { display:none; position:fixed; bottom:0; left:0; right:0; height:60vh; background:white; z-index:4500; border-top-left-radius:25px; border-top-right-radius:25px; flex-direction:column; box-shadow: 0 -5px 20px rgba(0,0,0,0.2); }

        /* Wallet & Profile */
        .wallet-card { margin: 15px; background: var(--primary-grad); border-radius: 20px; padding: 20px; color: white; box-shadow: 0 10px 20px rgba(255,143,163,0.3); }
        
        /* Gifts & Live */
        #liveOverlay { display: none; position: fixed; inset: 0; background: #000; z-index: 5000; flex-direction: column; }
        .gift-panel { position: absolute; bottom: -100%; left: 0; right: 0; background: white; border-top-left-radius: 25px; border-top-right-radius: 25px; padding: 20px; transition: 0.4s; z-index: 5001; display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .gift-panel.active { bottom: 0; }
    </style>
</head>
<body>
    <div id="splash">
        <i class="fa-solid fa-cloud splash-logo"></i>
        <h1 style="letter-spacing: 5px; margin-top: 15px;">PUFFLY</h1>
    </div>

    <div id="homeView" class="view-section active-view">
        <div class="reel-video">
            <div class="reel-overlay" style="position:absolute; bottom:100px; left:15px; text-shadow: 0 2px 10px rgba(0,0,0,0.5);">
                <h3>@Puffly_Official</h3>
                <p>Welcome to the Sovereign Cloud ‚òÅÔ∏è‚ú®</p>
            </div>

            <div class="reel-actions">
                <div style="position: relative; margin-bottom: 10px;">
                    <div style="width: 45px; height: 45px; border-radius: 50%; border: 2px solid white; background: #ddd; overflow: hidden;">
                        <img src="https://picsum.photos/100/100" style="width:100%; height:100%;">
                    </div>
                    <div id="followBtn" class="follow-badge" onclick="toggleFollow()">
                        <i class="fa-solid fa-plus" id="followIcon" style="color: white;"></i>
                    </div>
                </div>

                <div class="action-btn" onclick="openLive()">
                    <i class="fa-solid fa-tower-broadcast" style="color:#ff4d6d;"></i>
                    <p style="font-size:10px;">Live</p>
                </div>

                <div class="action-btn" id="likeBtn" onclick="toggleLike()">
                    <i class="fa-solid fa-cloud"></i>
                    <p style="font-size:10px;" id="likeCount">1.2K</p>
                </div>

                <div class="action-btn" onclick="openComments()">
                    <i class="fa-solid fa-comment-dots"></i>
                    <p style="font-size:10px;">1.2K</p>
                </div>
            </div>
        </div>

        <div id="commentSheet">
            <div style="padding:15px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center;">
                <b>‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå (1.2K)</b>
                <i class="fa-solid fa-xmark" onclick="closeComments()" style="font-size:20px; cursor:pointer;"></i>
            </div>
            <div id="reelsCommentBox" style="flex:1; overflow-y:auto; padding:15px; display:flex; flex-direction:column; gap:12px;">
                <div style="display:flex; gap:10px;">
                    <div style="width:30px; height:30px; border-radius:50%; background:#eee;"></div>
                    <div><p style="font-size:12px; font-weight:bold;">User_01</p><p style="font-size:13px;">‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏°‡∏≤‡∏Å‡πÄ‡∏•‡∏¢ ‚òÅÔ∏è</p></div>
                </div>
            </div>
            <div style="padding:15px; border-top:1px solid #eee; display:flex; gap:10px; background:white;">
                <input type="text" id="reelsInp" style="flex:1; background:#f8f8f8; border:none; padding:10px; border-radius:20px; outline:none;" placeholder="‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô...">
                <i class="fa-solid fa-paper-plane" style="color:var(--primary); font-size:18px; cursor:pointer;" onclick="sendReelComment()"></i>
            </div>
        </div>
    </div>

    <div id="inboxView" class="view-section">
        <div class="chat-header">
            <div style="width:40px; height:40px; border-radius:12px; background:var(--primary-grad); display:flex; align-items:center; justify-content:center; color:white;"><i class="fa-solid fa-cloud"></i></div>
            <div style="flex:1;"><b>Puffly Support</b><p style="font-size:10px; color:green;">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</p></div>
        </div>
        <div id="chatBox" style="padding:15px; display:flex; flex-direction:column; gap:10px; height:calc(100vh - 250px); overflow-y:auto;">
            <div class="bubble you">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞</div>
        </div>
        <div style="padding:15px; background:white; border-top:1px solid #eee;">
            <div style="display:flex; gap:10px; align-items:center;">
                <i class="fa-solid fa-face-smile" style="color:var(--primary); font-size:24px; cursor:pointer;" onclick="toggleStickerPanel()"></i>
                <input type="text" id="msgInput" style="flex:1; background:#f8f8f8; border:none; padding:10px; border-radius:20px; outline:none;" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...">
                <i class="fa-solid fa-paper-plane" style="color:var(--primary); font-size:20px; cursor:pointer;" onclick="sendMsg()"></i>
            </div>
            <div id="stickerPanel" style="display:none; grid-template-columns: repeat(4, 1fr); gap:10px; padding-top:10px;">
                <div class="sticker-item" onclick="buySticker('üê±', 5)"><span>üê±</span><p style="font-size:9px;">5 C</p></div>
                <div class="sticker-item" onclick="buySticker('‚òÅÔ∏è', 5)"><span>‚òÅÔ∏è</span><p style="font-size:9px;">5 C</p></div>
                <div class="sticker-item" onclick="buySticker('üëë', 100)"><span>üëë</span><p style="font-size:9px;">100 C</p></div>
                <div class="sticker-item" onclick="buySticker('üî•', 10)"><span>üî•</span><p style="font-size:9px;">10 C</p></div>
            </div>
        </div>
    </div>

    <div id="profileView" class="view-section">
        <div style="text-align:center; padding:30px;">
            <div style="width:80px; height:80px; border-radius:25px; background:var(--primary-grad); margin:0 auto 15px; color:white; font-size:30px; display:flex; align-items:center; justify-content:center;"><i class="fa-solid fa-user"></i></div>
            <h2>@Creator_Asura</h2>
        </div>
        <div class="wallet-card">
            <div style="display:flex; justify-content:space-between;">
                <div><p style="font-size:11px;">Coins ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</p><h1 id="userCoins">...</h1></div>
                <div style="text-align:right;"><p style="font-size:11px;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏∞‡∏™‡∏°</p><h2 id="userIncome">‡∏ø0.00</h2></div>
            </div>
            <button onclick="withdrawMoney()" style="width:100%; margin-top:15px; background:white; color:var(--primary); border:none; padding:10px; border-radius:10px; font-weight:bold;">‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</button>
        </div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('homeView', this)"><i class="fa-solid fa-house"></i><span>‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</span></div>
        <div class="nav-item" onclick="switchTab('inboxView', this)"><i class="fa-solid fa-comment-dots"></i><span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</span></div>
        <div class="nav-item" style="color:var(--primary);"><i class="fa-solid fa-circle-plus" style="font-size:35px;"></i></div>
        <div class="nav-item" onclick="alert('‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô')"><i class="fa-solid fa-magnifying-glass"></i><span>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</span></div>
        <div class="nav-item" onclick="switchTab('profileView', this)"><i class="fa-solid fa-user"></i><span>‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</span></div>
    </nav>
    <div id="liveOverlay">
        <div style="padding:20px; display:flex; justify-content:space-between; color:white; align-items:center;">
            <div style="display:flex; gap:10px; align-items:center;">
                <div style="background:red; padding:3px 12px; border-radius:5px; font-weight:bold; font-size:12px; animation: pulse 1.5s infinite;">LIVE</div>
                <div style="font-size:12px; background:rgba(0,0,0,0.3); padding:3px 8px; border-radius:5px;"><i class="fa-solid fa-eye"></i> 1.2K</div>
            </div>
            <i class="fa-solid fa-xmark" onclick="closeLive()" style="font-size:28px; cursor:pointer;"></i>
        </div>

        <div id="liveComments" style="flex:1; padding:20px; display:flex; flex-direction:column; justify-content:flex-end; gap:8px; color:white; overflow-y:auto;">
            <div style="color:rgba(255,255,255,0.7); font-size:12px;">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡πÑ‡∏•‡∏ü‡πå‡∏™‡∏î‡∏Ç‡∏≠‡∏á @Creator_Asura ‚òÅÔ∏è</div>
        </div>

        <div style="padding:15px 20px 30px; display:flex; gap:12px; align-items:center; background: linear-gradient(to top, rgba(0,0,0,0.5), transparent);">
            <input type="text" id="liveInp" style="flex:1; background:rgba(255,255,255,0.2); border:1px solid rgba(255,255,255,0.3); padding:12px 18px; border-radius:25px; color:white; outline:none;" placeholder="‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏Ñ‡∏£‡∏µ‡πÄ‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå...">
            
            <i class="fa-solid fa-paper-plane" style="color: white; font-size: 20px; cursor: pointer;" onclick="sendLiveComment()"></i>
            
            <div style="position:relative; cursor:pointer;" onclick="toggleGiftPanel(event)">
                <i class="fa-solid fa-gift" style="color:#ffd700; font-size:32px; filter: drop-shadow(0 0 10px rgba(255,215,0,0.5));"></i>
            </div>
        </div>

        <div id="giftPanel" class="gift-panel" onclick="event.stopPropagation()">
            <div style="grid-column: span 4; display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <b style="color:var(--text);">‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç</b>
                <span style="color:var(--primary); font-size:13px; font-weight:bold;">ü™ô <span id="liveCoinsUI">...</span></span>
            </div>
            
            <div class="sticker-item" style="border:1px solid #eee; padding:10px; border-radius:15px;" onclick="sendGift('üç≠', 10, 7)">
                <span style="font-size:28px;">üç≠</span>
                <p style="font-size:10px; margin-top:5px;">‡∏≠‡∏°‡∏¢‡∏¥‡πâ‡∏°</p>
                <small style="color:var(--muted);">10 C</small>
            </div>
            
            <div class="sticker-item" style="border:1px solid #eee; padding:10px; border-radius:15px;" onclick="sendGift('‚òÅÔ∏è', 50, 35)">
                <span style="font-size:28px;">‚òÅÔ∏è</span>
                <p style="font-size:10px; margin-top:5px;">‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏°‡∏Ü</p>
                <small style="color:var(--muted);">50 C</small>
            </div>
            
            <div class="sticker-item" style="border:1px solid #eee; padding:10px; border-radius:15px;" onclick="sendGift('üëë', 500, 350)">
                <span style="font-size:28px;">üëë</span>
                <p style="font-size:10px; margin-top:5px;">‡∏°‡∏á‡∏Å‡∏∏‡∏é</p>
                <small style="color:var(--muted);">500 C</small>
            </div>
            
            <div class="sticker-item" style="border:1px solid #eee; padding:10px; border-radius:15px;" onclick="sendGift('üïäÔ∏è', 1000, 700)">
                <span style="font-size:28px;">üïäÔ∏è</span>
                <p style="font-size:10px; margin-top:5px;">‡∏ô‡∏Å‡∏™‡∏±‡∏ô‡∏ï‡∏¥‡∏†‡∏≤‡∏û</p>
                <small style="color:var(--muted);">1K C</small>
            </div>

            <div style="grid-column: span 4; margin-top:10px;">
                <button onclick="alert('‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô PromptPay')" style="width:100%; padding:10px; border-radius:10px; border:none; background:#f8f8f8; color:var(--muted); font-size:11px;">‡πÄ‡∏ï‡∏¥‡∏° Coins</button>
            </div>
        </div>
    </div>

    <style>
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, onSnapshot, updateDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Firebase Config ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const firebaseConfig = {
            apiKey: "AIzaSyAT48SVlLZGo_XEYmf_K4MD06GqDLa_N9c",
            authDomain: "puffly-86e43.firebaseapp.com",
            projectId: "puffly-86e43",
            storageBucket: "puffly-86e43.firebasestorage.app",
            messagingSenderId: "841845436320",
            appId: "1:841845436320:web:61e2ff1988c48bc634fec5"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const userRef = doc(db, "users", "default_user");

        let myCoins = 0;
        let myIncome = 0;

        // --- 1. Real-time Data Sync (‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏á‡∏¥‡∏ô) ---
        onSnapshot(userRef, (snap) => {
            if (snap.exists()) {
                myCoins = snap.data().coins || 0;
                myIncome = snap.data().income || 0;
                updateUI();
            } else {
                setDoc(userRef, { coins: 1000, income: 0 });
            }
        });

        function updateUI() {
            document.getElementById('userCoins').innerText = myCoins.toLocaleString();
            document.getElementById('liveCoinsUI').innerText = myCoins.toLocaleString();
            document.getElementById('userIncome').innerText = "‡∏ø" + myIncome.toFixed(2);
        }

        // --- 2. ‡∏£‡∏∞‡∏ö‡∏ö Navigation (‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠) ---
        window.switchTab = (viewId, el) => {
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active-view'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(viewId).classList.add('active-view');
            el.classList.add('active');
            // ‡∏õ‡∏¥‡∏î‡∏ñ‡∏≤‡∏î‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤
            closeComments();
        };

        // --- 3. ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÉ‡∏ï‡πâ‡∏Ñ‡∏•‡∏¥‡∏õ (‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡πÅ‡∏ä‡∏ó) ---
        window.openComments = () => document.getElementById('commentSheet').style.display = 'flex';
        window.closeComments = () => document.getElementById('commentSheet').style.display = 'none';
        
        window.sendReelComment = () => {
            const inp = document.getElementById('reelsInp');
            if (!inp.value.trim()) return;
            const box = document.getElementById('reelsCommentBox');
            const div = document.createElement('div');
            div.style.display = "flex"; div.style.gap = "10px";
            div.innerHTML = `<div style="width:30px; height:30px; border-radius:50%; background:var(--primary-grad);"></div>
                             <div><p style="font-size:12px; font-weight:bold;">‡∏Ñ‡∏∏‡∏ì</p><p style="font-size:13px;">${inp.value}</p></div>`;
            box.appendChild(div);
            box.scrollTop = box.scrollHeight;
            inp.value = "";
        };

        // --- 4. ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ä‡∏ó‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß & ‡∏£‡πâ‡∏≤‡∏ô‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå (‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÅ‡∏≠‡∏õ) ---
        window.sendMsg = () => {
            const inp = document.getElementById('msgInput');
            if (!inp.value.trim()) return;
            const msg = document.createElement('div');
            msg.className = "bubble me"; msg.innerText = inp.value;
            document.getElementById('chatBox').appendChild(msg);
            document.getElementById('chatBox').scrollTop = document.getElementById('chatBox').scrollHeight;
            inp.value = "";
        };

        window.toggleStickerPanel = () => {
            const p = document.getElementById('stickerPanel');
            p.style.display = p.style.display === 'none' ? 'grid' : 'none';
        };

        window.buySticker = async (icon, price) => {
            if (myCoins >= price) {
                await updateDoc(userRef, { coins: myCoins - price });
                const msg = document.createElement('div');
                msg.className = "bubble me"; msg.style.background = "none"; msg.style.fontSize = "40px";
                msg.innerText = icon;
                document.getElementById('chatBox').appendChild(msg);
                document.getElementById('stickerPanel').style.display = 'none';
            } else { alert("Coins ‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏Ñ‡πà‡∏∞"); }
        };

        // --- 5. ‡∏£‡∏∞‡∏ö‡∏ö Live & ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç (‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏µ‡πÄ‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå) ---
        window.openLive = () => document.getElementById('liveOverlay').style.display = 'flex';
        window.closeLive = () => document.getElementById('liveOverlay').style.display = 'none';
        window.toggleGiftPanel = (e) => { e.stopPropagation(); document.getElementById('giftPanel').classList.toggle('active'); };

        window.sendGift = async (icon, cost, creatorEarn) => {
            if (myCoins >= cost) {
                await updateDoc(userRef, { coins: myCoins - cost, income: myIncome + creatorEarn });
                const item = document.createElement('div');
                item.innerHTML = `<b style="color:#ffd700;">üéÅ ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç:</b> ‡∏Ñ‡∏∏‡∏ì‡∏™‡πà‡∏á ${icon}`;
                document.getElementById('liveComments').appendChild(item);
                document.getElementById('giftPanel').classList.remove('active');
            } else { alert("Coins ‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏Ñ‡πà‡∏∞"); }
        };

        window.sendLiveComment = () => {
            const inp = document.getElementById('liveInp');
            if (!inp.value.trim()) return;
            const comm = document.createElement('div');
            comm.innerHTML = `<span style="color:var(--primary);">‡∏Ñ‡∏∏‡∏ì:</span> <span style="color:white;">${inp.value}</span>`;
            document.getElementById('liveComments').appendChild(comm);
            document.getElementById('liveComments').scrollTop = document.getElementById('liveComments').scrollHeight;
            inp.value = "";
        };

        // --- 6. ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏• (Like Cloud & Follow) ---
        window.toggleLike = () => {
            const btn = document.getElementById('likeBtn');
            const isLiked = btn.classList.toggle('liked');
            document.getElementById('likeCount').innerText = isLiked ? "1.2K+1" : "1.2K";
        };

        window.toggleFollow = () => {
            const badge = document.getElementById('followBtn');
            const isFollowed = badge.classList.toggle('followed');
            document.getElementById('followIcon').className = isFollowed ? "fa-solid fa-check" : "fa-solid fa-plus";
        };

        window.withdrawMoney = async () => {
            if (myIncome <= 0) return alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÉ‡∏´‡πâ‡∏ñ‡∏≠‡∏ô");
            if (confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô?")) {
                await updateDoc(userRef, { income: 0 });
                alert("‡∏ñ‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
            }
        };

        // Splash Screen
        setTimeout(() => {
            document.getElementById('splash').style.opacity = '0';
            setTimeout(() => document.getElementById('splash').style.display = 'none', 800);
        }, 2000);

        document.addEventListener('click', () => document.getElementById('giftPanel').classList.remove('active'));
    </script>
</body>
</html>
